{% extends "base.html" %}

{% block title %}{{ _("Mirrors") }}{% end block %}

{% block body %}
	<ul class="breadcrumb">
		<li>
			<a href="/">{{ _("Home") }}</a>
			<span class="divider">/</span>
		</li>
		<li class="active">
			<a href="/mirrors">{{ _("Mirrors") }}</a>
		</li>
	</ul>

	{% if current_user and current_user.has_perm("manage_mirrors") %}
		<div class="btn-group pull-right">
			<a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
				{{ _("Actions") }} <span class="caret"></span>
			</a>
			<ul class="dropdown-menu">
				<li>
					<a href="/mirror/new">
						<i class="icon-asterisk"></i> {{ _("Add new mirror") }}
					</a>
				</li>
			</ul>
		</div>
	{% end %}

	<div class="page-header">
		<h2>{{ _("Mirrors") }}</h2>
	</div>

	<p>
		{{ _("On this page, you will see a list of all mirror servers.") }}
	</p>

	{% if mirrors %}
		<table class="table table-striped table-hover">
			<thead>
				<tr>
					<th>{{ _("Hostname") }} / {{ _("Owner") }}</th>
					<th></th>
					<th>{{ _("Last check") }}</th>
				</tr>
			</thead>
			<tbody>
				{% for mirror in mirrors %}
					<tr>
						<td>
							<a href="/mirror/{{ mirror.hostname }}">
								{{ mirror.hostname }}
							</a>
							<p class="muted">
								{{ mirror.owner or _("N/A") }}
							</p>
						</td>
						<td>
							[{{ mirror.country_code }}] -

							{% if mirror.status == "OK" %}
								<span class="text-success">
									{{ _("Up") }}
								</span>
							{% elif mirror.status == "OUTOFSYNC" %}
								<span class="text-warning">
									{{ _("Out Of Sync") }}
								</span>
							{% elif mirror.status == "ERROR" %}
								<span class="text-error">
									{{ _("Down") }}
								</span>
							{% else %}
								<span class="muted">
									{{ _("Unknown") }}
								</span>
							{% end %}
						</td>

						<td>
							{% if mirror.last_check %}
								{{ format_date(mirror.last_check.timestamp, relative=True) }}
							{% else %}
								{{ _("N/A") }}
							{% end %}
						</td>
					</tr>
				{% end %}
			</tbody>
		</table>
	{% else %}
		<p class="muted">
			{{ _("There are no mirrors configured, yet.") }}
		</p>
	{% end %}

	{% if log %}
		<h2>{{ _("Log") }}</h2>
		{% module Log(log) %}
	{% end %}
{% end block %}
