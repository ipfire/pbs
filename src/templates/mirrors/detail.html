{% extends "../base.html" %}

{% block title %}{{ _("Mirror: %s") % mirror.hostname }}{% end block %}

{% block body %}
	<ul class="breadcrumb">
		<li>
			<a href="/">{{ _("Home") }}</a>
			<span class="divider">/</span>
		</li>
		<li>
			<a href="/mirrors">{{ _("Mirrors") }}</a>
			<span class="divider">/</span>
		</li>
		<li class="active">
			<a href="/mirror/{{ mirror.hostname }}">{{ mirror.hostname }}</a>
		</li>
	</ul>

	{% if current_user and current_user.has_perm("manage_mirrors") %}
		<div class="btn-group pull-right">
			<a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
				{{ _("Actions") }} <span class="caret"></span>
			</a>
			<ul class="dropdown-menu">
				<li>
					<a href="/mirror/{{ mirror.hostname }}/edit">
						<i class="icon-edit"></i>
						{{ _("Edit settings") }}
					</a>
				</li>

				<li class="divider"></li>
				<li>
					<a href="/mirror/{{ mirror.hostname }}/delete">
						<i class="icon-trash"></i>
						{{ _("Delete mirror") }}
					</a>
				</li>
			</ul>
		</div>
	{% end %}

	<div class="page-header">
		<h2>
			{{ _("Mirror: %s") % mirror.hostname }}
			<small>{{ mirror.owner }}</small>
		</h2>
	</div>

	<div class="row">
		<div class="span6">
			<table class="table table-striped table-hover">
				<tbody>
					<tr>
						<td>{{ _("Hostname") }}</td>
						<td>{{ mirror.hostname }}</td>
					</tr>

					{% if current_user and current_user.has_perm("manage_mirrors") %}
						<tr>
							<td>{{ _("Contact") }}</td>
							<td>
								{% if mirror.contact %}
									<a href="mailto:{{ mirror.contact }}">{{ mirror.contact }}</a>
								{% else %}
									{{ _("N/A") }}
								{% end %}
							</td>
						</tr>
					{% end %}
				</tbody>
			</table>

			<h3>{{ _("Status information") }}</h3>
			<table class="table table-striped table-hover">
				<tbody>
					{% if not mirror.status == "OK" %}
						<tr>
							<td>{{ _("Status") }}</td>
							<td>{{ mirror.status }}</td>
						</tr>

						{% if mirror.status == "ERROR" %}
							<tr>
								<td>{{ _("HTTP Response Code") }}</td>
								<td>{{ mirror.last_check.http_status }}</td>
							</tr>
						{% end %}

						{% if mirror.last_check and mirror.last_check.last_sync_at %}
							<tr>
								<td>{{ _("Last sync") }}</td>
								<td>
									{{ locale.format_date(mirror.last_check.last_sync_at) }}
								</td>
							</tr>
						{% end %}

						<tr>
							<td>{{ _("Last check") }}</td>
							<td>
								{% if mirror.last_check %}
									{{ format_date(mirror.last_check.timestamp) }}
								{% else %}
									{{ _("Never") }}
								{% end %}
							</td>
						</tr>
					{% end %}

					{% if mirror.average_response_time %}
						<tr>
							<td>{{ _("Average Response Time") }}</td>
							<td>
								{{ "%.2fms" % (mirror.average_response_time * 1000) }}
							</td>
						</tr>
					{% end %}
				</tbody>
			</table>
		</div>

		<div class="span6">
			<p class="muted">
				{{ _("The location of the mirror server could not be estimated.") }}
			</p>
		</div>
	</div>

	{% if log %}
		<h3>{{ _("Log") }}</h3>
		{% module Log(log) %}
	{% end %}
{% end block %}
